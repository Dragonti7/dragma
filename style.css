:root {
    --bg-gradient: radial-gradient(circle at center, #FFF8E1, #FDF5E6, #FFE4E1);
    --text-color: #4A4A4A;
    --heading-color: #5D4037;
    --subheading-color: #8D6E63;
    --accent-color: #FF6F61;
    --accent-hover: #E65B50;
    --paper-bg: #FFFAF0;

    /* Dynamic variables updated via JS or CSS classes */
    --cookie-stroke-dynamic: #D2691E;
    --text-shadow-color: rgba(0, 0, 0, 0.1);
    --glow-color: rgba(255, 215, 0, 0.6);
}

/* Night Mode Colors */
body.night-mode {
    --bg-gradient: radial-gradient(circle at center, #1A237E, #121858, #0B0F3A);
    /* Deep Navy Night Sky */
    --text-color: #E0E0E0;
    --heading-color: #FFF59D;
    /* Pale yellow */
    --subheading-color: #B39DDB;
    /* Light purple */
    --cookie-stroke-dynamic: #311B92;
    /* Deep purple stroke */
    --text-shadow-color: rgba(255, 255, 255, 0.2);
    --glow-color: rgba(179, 157, 219, 0.6);
    /* Purple glow */
}

body {
    margin: 0;
    padding: 0;
    font-family: 'Noto Sans KR', sans-serif;
    background: var(--bg-gradient);
    color: var(--text-color);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    overflow: hidden;
    transition: background 1.5s ease;
}

.container {
    text-align: center;
    width: 100%;
    max-width: 600px;
    padding: 20px;
    position: relative;
    z-index: 1;
}

header h1 {
    font-size: 2.2rem;
    margin-bottom: 0.5rem;
    color: var(--heading-color);
    text-shadow: 2px 2px 4px var(--text-shadow-color);
    animation: float 4s ease-in-out infinite;
    transition: color 1s;
}

header p {
    font-size: 1.2rem;
    color: var(--subheading-color);
    margin-bottom: 3rem;
    transition: color 1s;
}

@keyframes float {

    0%,
    100% {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-5px);
    }
}

.cookie-container {
    position: relative;
    width: 320px;
    height: 320px;
    margin: 0 auto;
    cursor: pointer;
    transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), filter 0.4s;
    filter: drop-shadow(0 15px 25px rgba(210, 105, 30, 0.3));
    border-radius: 50%;
}

body.night-mode .cookie-container {
    filter: drop-shadow(0 15px 35px rgba(126, 87, 194, 0.6));
    /* Purple glow behind whole cookie */
}

.cookie-container:focus-visible {
    outline: 3px solid var(--accent-color);
    outline-offset: 10px;
}

.cookie-container:hover {
    transform: scale(1.08) translateY(-10px);
    filter: drop-shadow(0 25px 35px rgba(255, 165, 0, 0.5));
}

body.night-mode .cookie-container:hover {
    filter: drop-shadow(0 25px 45px rgba(179, 157, 219, 0.8));
}

svg#fortune-cookie {
    width: 100%;
    height: 100%;
    overflow: visible;
}

/* SVG Fill Handling for GitHub Pages Compatibility */
.cookie-fill {
    fill: #F4C430;
    /* Solid Gold Day Color */
    transition: fill 1s;
}

body.night-mode .cookie-fill {
    fill: #7E57C2;
    /* Solid Purple Night Color */
}

.cookie-part {
    transition: transform 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55), opacity 0.5s ease;
    transform-origin: 100px 100px;
}

/* Animation Classes */
.cracked .cookie-part#cookie-left {
    transform: rotate(-45deg) translate(-50px, 30px);
}

.cracked .cookie-part#cookie-right {
    transform: rotate(45deg) translate(50px, 30px);
}

/* Message Container */
#message-container {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 95%;
    max-width: 520px;
    z-index: -1;
    pointer-events: none;
    perspective: 1000px;
}

.cracked #message-container {
    z-index: 10;
    pointer-events: auto;
}

.fortune-paper {
    background: linear-gradient(135deg, #FFFFFC, #FFF3E0);
    border: 3px dashed #C8B9B4;
    padding: 30px 20px;
    box-shadow: 0 0 40px var(--glow-color), 0 15px 35px rgba(0, 0, 0, 0.3);
    border-radius: 6px;
    min-height: 180px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    opacity: 0;
    transform: rotateX(60deg) scale(0.5);
    transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) 0.3s;
}

.fortune-content-wrapper {
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.cracked .fortune-paper {
    opacity: 1;
    transform: rotateX(0deg) scale(1.05);
}

/* Add a tape look at the top */
.fortune-paper::before {
    content: '';
    position: absolute;
    top: -15px;
    left: 50%;
    width: 120px;
    height: 35px;
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
    transform: translateX(-50%) rotate(-3deg);
}

#fortune-text {
    font-family: 'Nanum Pen Script', cursive;
    font-size: 2.4rem;
    line-height: 1.3;
    color: #2D1A11;
    word-break: keep-all;
    text-shadow: 2px 2px 0px rgba(255, 255, 255, 0.9), 0px 4px 10px rgba(0, 0, 0, 0.15);
    font-weight: bold;
    margin-bottom: 20px;
    /* Space between text and stats */
    width: 100%;
}

body.night-mode #fortune-text {
    color: #311B92;
    /* Night specific text color, still readable on paper */
}

/* Stat Bars UI */
.stat-container {
    width: 90%;
    display: flex;
    flex-direction: column;
    gap: 12px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    padding-top: 20px;
    opacity: 0;
    /* Hidden initially until text is done */
    transition: opacity 0.5s ease 0.5s;
}

.cracked .stat-container:not(.hidden) {
    opacity: 1;
}

.stat-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 0.95rem;
    font-weight: bold;
    color: #5D4037;
    position: relative;
}

.stat-label {
    width: 80px;
    text-align: left;
}

.stat-bar-bg {
    flex-grow: 1;
    height: 14px;
    background: rgba(0, 0, 0, 0.08);
    border-radius: 10px;
    margin: 0 15px;
    overflow: hidden;
    position: relative;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
}

.stat-bar-fill {
    height: 100%;
    width: 0%;
    /* Start empty */
    border-radius: 10px;
    transition: width 1.5s cubic-bezier(0.2, 0.8, 0.2, 1);
    position: relative;
}

/* Subtle shine effect inside the bar */
.stat-bar-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
    animation: shine-bar 2s linear infinite;
}

@keyframes shine-bar {
    0% {
        transform: translateX(-100%);
    }

    100% {
        transform: translateX(100%);
    }
}

.stat-bar-fill.wealth {
    background: linear-gradient(90deg, #F4C430, #FFD700);
}

.stat-bar-fill.love {
    background: linear-gradient(90deg, #FF8A80, #FF5252);
}

.stat-bar-fill.health {
    background: linear-gradient(90deg, #81C784, #4CAF50);
}

.stat-value {
    width: 45px;
    text-align: right;
    font-family: monospace;
    font-size: 1.1rem;
}

/* Critical Effect */
.stat-crit {
    position: absolute;
    right: -20px;
    top: -15px;
    color: #D50000;
    font-size: 0.8rem;
    font-weight: 900;
    text-shadow: 0 2px 4px rgba(255, 255, 255, 0.9);
    transform: rotate(15deg);
    animation: pulse-crit 0.5s infinite alternate;
}

@keyframes pulse-crit {
    0% {
        transform: rotate(15deg) scale(1);
    }

    100% {
        transform: rotate(15deg) scale(1.3);
    }
}

/* Utility Classes */
.hidden {
    display: none !important;
    opacity: 0;
    pointer-events: none;
    visibility: hidden;
}

/* Reset Button */
#reset-btn {
    margin-top: 60px;
    padding: 15px 40px;
    background: linear-gradient(135deg, var(--accent-color), #FF8A80);
    color: white;
    border: none;
    border-radius: 50px;
    font-size: 1.2rem;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(255, 111, 97, 0.4), inset 0 -3px 0 rgba(0, 0, 0, 0.1);
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    opacity: 1;
    visibility: visible;
}

body.night-mode #reset-btn {
    background: linear-gradient(135deg, #7E57C2, #5E35B1);
    box-shadow: 0 4px 15px rgba(126, 87, 194, 0.4), inset 0 -3px 0 rgba(0, 0, 0, 0.1);
}

#reset-btn.hidden {
    opacity: 0;
    pointer-events: none;
    visibility: hidden;
    transform: translateY(20px);
}

#reset-btn:hover {
    transform: translateY(-5px) scale(1.05);
    box-shadow: 0 8px 25px rgba(255, 111, 97, 0.6), inset 0 -3px 0 rgba(0, 0, 0, 0.1);
}

body.night-mode #reset-btn:hover {
    box-shadow: 0 8px 25px rgba(126, 87, 194, 0.6), inset 0 -3px 0 rgba(0, 0, 0, 0.1);
}

#reset-btn:active {
    transform: translateY(1px);
    box-shadow: 0 2px 10px rgba(255, 111, 97, 0.4);
}

/* Shake Animation */
.shake {
    animation: shake-anim 1.8s cubic-bezier(.36, .07, .19, .97) both;
}

@keyframes shake-anim {

    0%,
    100% {
        transform: translate3d(0, 0, 0) rotate(0deg);
    }

    10%,
    30%,
    50%,
    70%,
    90% {
        transform: translate3d(-3px, -2px, 0) rotate(-2deg);
    }

    20%,
    40%,
    60%,
    80% {
        transform: translate3d(3px, 2px, 0) rotate(2deg);
    }
}

/* Flash Effect (Full Screen) */
.flash {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: radial-gradient(circle, #fff, transparent);
    pointer-events: none;
    z-index: 100;
    opacity: 0;
    animation: flash-anim 1s ease-out forwards;
}

body.night-mode .flash {
    background: radial-gradient(circle, #D1C4E9, transparent);
}

@keyframes flash-anim {
    0% {
        opacity: 0.8;
        background-color: white;
    }

    50% {
        opacity: 0.5;
        background-color: rgba(255, 255, 255, 0.5);
    }

    100% {
        opacity: 0;
    }
}

/* God Rays (Holy Light) */
.god-rays {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 800px;
    height: 800px;
    background: conic-gradient(from 0deg,
            transparent 0deg, rgba(255, 235, 150, 0.5) 20deg, transparent 40deg,
            rgba(255, 235, 150, 0.5) 60deg, transparent 80deg, rgba(255, 235, 150, 0.5) 100deg,
            transparent 120deg, rgba(255, 235, 150, 0.5) 140deg, transparent 160deg,
            rgba(255, 235, 150, 0.5) 180deg, transparent 200deg, rgba(255, 235, 150, 0.5) 220deg,
            transparent 240deg, rgba(255, 235, 150, 0.5) 260deg, transparent 280deg,
            rgba(255, 235, 150, 0.5) 300deg, transparent 320deg, rgba(255, 235, 150, 0.5) 340deg,
            transparent 360deg);
    border-radius: 50%;
    z-index: -2;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.8s ease-in;
    filter: blur(10px);
}

body.night-mode .god-rays {
    background: conic-gradient(from 0deg,
            transparent 0deg, rgba(149, 117, 205, 0.3) 20deg, transparent 40deg,
            rgba(149, 117, 205, 0.3) 60deg, transparent 80deg, rgba(149, 117, 205, 0.3) 100deg,
            transparent 120deg, rgba(149, 117, 205, 0.3) 140deg, transparent 160deg,
            rgba(149, 117, 205, 0.3) 180deg, transparent 200deg, rgba(149, 117, 205, 0.3) 220deg,
            transparent 240deg, rgba(149, 117, 205, 0.3) 260deg, transparent 280deg,
            rgba(149, 117, 205, 0.3) 300deg, transparent 320deg, rgba(149, 117, 205, 0.3) 340deg,
            transparent 360deg);
}


.cracked .god-rays {
    opacity: 1;
    animation: rotate-rays 15s linear infinite;
}

@keyframes rotate-rays {
    from {
        transform: translate(-50%, -50%) rotate(0deg) scale(1);
    }

    50% {
        transform: translate(-50%, -50%) rotate(180deg) scale(1.1);
    }

    to {
        transform: translate(-50%, -50%) rotate(360deg) scale(1);
    }
}

/* Particle Effects */
.particle {
    position: fixed;
    pointer-events: none;
    z-index: 20;
    opacity: 0;
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.9);
}

body.night-mode .particle {
    box-shadow: 0 0 20px rgba(179, 157, 219, 0.9);
    /* Purple glow for night particles */
}

@keyframes pop {
    0% {
        transform: translate(0, 0) scale(0.5) rotate(0deg);
        opacity: 1;
    }

    50% {
        opacity: 1;
    }

    100% {
        transform: translate(var(--tx), var(--ty)) scale(1.5) rotate(var(--r));
        opacity: 0;
    }
}

/* Cute Characters */
.cute-character {
    position: fixed;
    pointer-events: none;
    z-index: 25;
    font-size: 2.5rem;
    opacity: 0;
    text-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.8));
}

body.night-mode .cute-character {
    filter: drop-shadow(0 0 10px rgba(179, 157, 219, 0.8));
}

@keyframes jump-out {
    0% {
        transform: translate(0, 0) scale(0) rotate(0deg);
        opacity: 0;
    }

    10% {
        opacity: 1;
    }

    50% {
        transform: translate(var(--tx), calc(var(--ty) - 150px)) scale(1.5) rotate(calc(var(--r) / 2));
    }

    80% {
        opacity: 1;
    }

    100% {
        transform: translate(var(--tx), var(--ty)) scale(1) rotate(var(--r));
        opacity: 0;
    }
}

/* Background Text Absorption */
#bg-text-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    overflow: hidden;
    z-index: 5;
    display: none;
}

.absorb-letter {
    position: fixed;
    font-family: 'Nanum Pen Script', cursive;
    font-size: 2.5rem;
    color: #FF6F61;
    text-shadow: 0 0 10px rgba(255, 111, 97, 0.8), 2px 2px 0px white;
    font-weight: bold;
    opacity: 0;
    animation: absorb-anim 1s cubic-bezier(0.55, 0.085, 0.68, 0.53) forwards;
}

body.night-mode .absorb-letter {
    color: #B39DDB;
    text-shadow: 0 0 10px rgba(179, 157, 219, 0.8), 2px 2px 0px #1A237E;
}

@keyframes absorb-anim {
    0% {
        transform: translate(0, 0) scale(1.5);
        opacity: 0;
    }

    15% {
        opacity: 1;
    }

    100% {
        transform: translate(var(--tx), var(--ty)) scale(0) rotate(360deg);
        opacity: 0;
    }
}


/* Mobile Responsiveness */
@media (max-width: 480px) {
    .cookie-container {
        width: 260px;
        height: 260px;
    }

    header h1 {
        font-size: 1.7rem;
    }

    header p {
        font-size: 1rem;
    }

    #fortune-text {
        font-size: 2.0rem;
    }

    .fortune-paper {
        padding: 25px 15px;
        min-height: 120px;
    }

    .absorb-letter {
        font-size: 2rem;
    }

    .stat-label {
        width: 60px;
        font-size: 0.85rem;
    }

    .stat-value {
        font-size: 0.95rem;
    }

    .stat-bar-bg {
        margin: 0 8px;
    }
}